@{
    // Session'dan AdminId'yi al ve veritabanından Admin objesini çek
    var dB = new WebApplication.Models.DataContext.BlogDBContext();
    WebApplication.Models.Model.Admin loggedInAdmin = null;
    WebApplication.Models.Model.Admin currentAdmin = null;
    
    if (Session["Admin"] != null)
    {
        int adminId = (int)Session["Admin"];
        loggedInAdmin = dB.Admin.Find(adminId);
        currentAdmin = loggedInAdmin;
    }
    
    bool isAdmin = (currentAdmin != null && currentAdmin.Authority == "Admin");
    bool isEditor = (currentAdmin != null && (currentAdmin.Authority == "Admin" || currentAdmin.Authority == "Editor"));
}

<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>@ViewBag.Title - Admin Panel</title>

    @*JQUERY DATA TABLES*@
    <link rel="stylesheet" href="https://cdn.datatables.net/2.0.8/css/dataTables.bootstrap5.min.css">

    @*BOOTSTRAP*@
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-9ndCyUa6mY5uZwWW9cDjGo4T0bKc3bOdfbDJVtC5ZtXoV2bIE4mUW5yLaGxB1wP7" crossorigin="anonymous">

    <link href="~/Content/AdminLayout/assets/libs/chartist/dist/chartist.min.css" rel="stylesheet">
    <link href="~/Content/AdminLayout/dist/css/style.min.css" rel="stylesheet">
    <link href="~/Content/Site.css" rel="stylesheet" />

    @*CKEDITOR*@
    <script src="https://cdn.ckeditor.com/4.22.1/full/ckeditor.js"></script>

    @*Font Awesome*@
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
        integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Admin Panel">
    <meta name="author" content="Aytuğ Otmar">
    <link rel="icon" type="image/png" sizes="16x16" href="@Url.Content(ViewBag.SiteLogo.LogoURL)">
</head>

<body>
    <div class="preloader">
        <div class="lds-ripple">
            <div class="lds-pos"></div>
            <div class="lds-pos"></div>
        </div>
    </div>

    <div id="main-wrapper" data-navbarbg="skin6" data-theme="light" data-layout="vertical" data-sidebartype="full"
         data-boxed-layout="full">
        <header class="topbar" data-navbarbg="skin6">
            <nav class="navbar top-navbar navbar-expand-md navbar-light">
                <div class="navbar-header" data-logobg="skin5">
                    <a class="nav-toggler waves-effect waves-light d-block d-md-none" href="javascript:void(0)">
                        <i class="ti-menu ti-close"></i>
                    </a>
                    <div class="navbar-brand  w-100 d-flex justify-content-center align-items-center p-0 m-0">
                        <a href="/" class="d-block">
                            <img src="@Url.Content(ViewBag.SiteLogo.LogoURL)" alt="Logo"
                                 style="height:100%; max-height:75px; object-fit:contain;" />
                        </a>
                    </div>
                    <a class="topbartoggler d-block d-md-none waves-effect waves-light" href="javascript:void(0)"
                       data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
                       aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                        <i class="ti-more"></i>
                    </a>
                </div>

                <div class="navbar-collapse collapse" id="navbarSupportedContent" data-navbarbg="skin6">
                    @*<ul class="navbar-nav float-start mr-auto">
                        <li class="nav-item search-box">
                            <a class="nav-link waves-effect waves-dark" href="javascript:void(0)">
                                <div class="d-flex align-items-center">
                                    <i class="mdi mdi-magnify font-20 me-1"></i>
                                    <div class="ms-1 d-none d-sm-block">
                                        <span>Ara</span>
                                    </div>
                                </div>
                            </a>
                            <form class="app-search position-absolute">
                                <input type="text" class="form-control" placeholder="Search &amp; enter">
                                <a class="srh-btn">
                                    <i class="ti-close"></i>
                                </a>
                            </form>
                        </li>
                    </ul>*@
                    <ul class="navbar-nav ms-auto">
                        @* float-end yerine Bootstrap 5 için ms-auto kullanalım *@
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle text-muted waves-effect waves-dark pro-pic" href="#"
                               id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                <img src="/Uploads/ID/user_icon.png" alt="user" class="rounded-circle" width="31">
                            </a>
                            <div class="dropdown-menu dropdown-menu-end user-dd animated"
                                 aria-labelledby="navbarDropdown">

                                @if (loggedInAdmin != null)
                                {
                                    <a class="dropdown-item" href="@(isAdmin ? $"/Admin/Edit/{loggedInAdmin.AdminId}" : (isEditor ? $"/Profile/Edit/{loggedInAdmin.AdminId}" : "#"))">
                                        <i class="fas fa-user-gear me-5 ms-5"></i>
                                        <span>@loggedInAdmin.Name @loggedInAdmin.Surname</span>
                                    </a>
                                }

                                <a class="dropdown-item" href="/Admin/Logout">
                                    <i class="fas fa-right-from-bracket me-5 ms-5"></i> Çıkış Yap
                                </a>
                            </div>
                        </li>
                    </ul>
                </div>
            </nav>
        </header>

        <aside class="left-sidebar" data-sidebarbg="skin5">
            <div class="scroll-sidebar">
                <nav class="sidebar-nav">
                    <ul id="sidebarnav">
                        @if (isAdmin)
                        {
                            <li class="sidebar-item">
                                <a class="sidebar-link waves-effect waves-dark sidebar-link" href="/Admin"
                                   aria-expanded="false">
                                    <i class="mdi mdi-av-timer"></i>
                                    <span class="hide-menu">Kullanıcı Yönetimi</span>
                                </a>
                            </li>
                            <li class="sidebar-item">
                                <a class="sidebar-link waves-effect waves-dark sidebar-link" href="/About_Us"
                                   aria-expanded="false">
                                    <i class="mdi mdi-information"></i>
                                    <span class="hide-menu">Hakkımızda</span>
                                </a>
                            </li>
                            <li class="sidebar-item">
                                <a class="sidebar-link waves-effect waves-dark sidebar-link" href="/Contact"
                                   aria-expanded="false">
                                    <i class="mdi mdi-phone"></i>
                                    <span class="hide-menu">İletişim</span>
                                </a>
                            </li>
                            <li class="sidebar-item">
                                <a class="sidebar-link waves-effect waves-dark sidebar-link" href="/ID"
                                   aria-expanded="false">
                                    <i class="mdi mdi-account-card-details"></i>
                                    <span class="hide-menu">Site Kimliği</span>
                                </a>
                            </li>
                            <li class="sidebar-item">
                                <a class="sidebar-link waves-effect waves-dark sidebar-link" href="/Services"
                                   aria-expanded="false">
                                    <i class="mdi mdi-apps"></i>
                                    <span class="hide-menu">Hizmetler</span>
                                </a>
                            </li>
                            <li class="sidebar-item">
                                <a class="sidebar-link waves-effect waves-dark sidebar-link" href="/Author"
                                   aria-expanded="false">
                                    <i class="mdi mdi-shield"></i>
                                    <span class="hide-menu">Yazarlar</span>
                                </a>
                            </li>
                            <li class="sidebar-item">
                                <a class="sidebar-link waves-effect waves-dark sidebar-link" href="/Comment"
                                   aria-expanded="false">
                                    <i class="fas fa-comments"></i>
                                    <span class="hide-menu">
                                        Yorum Yönetimi
                                        @if (ViewBag.PendingCommentCount != null && ViewBag.PendingCommentCount > 0)
                                        {
                                            <span class="badge bg-warning text-dark ms-2">@ViewBag.PendingCommentCount</span>
                                        }
                                    </span>
                                </a>
                            </li>
                        }
                        @if (isEditor)
                        {
                            <li class="sidebar-item">
                                <a class="sidebar-link waves-effect waves-dark sidebar-link" href="/Blog"
                                   aria-expanded="false">
                                    <i class="mdi mdi-blogger"></i>
                                    <span class="hide-menu">Blog</span>
                                </a>
                            </li>
                            <li class="sidebar-item">
                                <a class="sidebar-link waves-effect waves-dark sidebar-link" href="/Category"
                                   aria-expanded="false">
                                    <i class="mdi mdi-sort"></i>
                                    <span class="hide-menu">Kategoriler</span>
                                </a>
                            </li>
                        }
                        <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link" href="/" aria-expanded="false">
                                <i class="mdi mdi-home"></i>
                                <span class="hide-menu">Ana Sayfa</span>
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
        </aside>

        <div class="page-wrapper">
            <div class="container-fluid">
                @RenderBody()
            </div>
        </div>
    </div>
    <footer class="footer text-center">
        <div class="copyright">
            <p>&copy; @DateTime.Now.Year IEEE YTU. All right reserved.</p>
            <div class="credits">
                Designed by <a target="_blank" href="https://www.linkedin.com/in/aytugotmar/">Aytuğ Otmar</a>
            </div>
        </div>
    </footer>

    @RenderSection("Scripts", required: false)

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script src="https://cdn.datatables.net/2.0.8/js/dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/2.0.8/js/dataTables.bootstrap5.min.js"></script>

    <script>
        $(document).ready(function () {
            $('#myTable').DataTable({
                responsive: true,
                autoWidth: false,
                "language": {
                    "sDecimal": ",",
                    "sEmptyTable": "Tabloda herhangi bir veri mevcut değil",
                    "sInfo": "_TOTAL_ kayıttan _START_ ile _END_ arasındaki kayıtlar gösteriliyor",
                    "sInfoEmpty": "Kayıt yok",
                    "sInfoFiltered": "(_MAX_ kayıt içerisinden bulunan)",
                    "sInfoPostFix": "",
                    "sInfoThousands": ".",
                    "sLengthMenu": "Sayfada _MENU_ kayıt göster",
                    "sLoadingRecords": "Yükleniyor...",
                    "sProcessing": "İşleniyor...",
                    "sSearch": "Ara:",
                    "sZeroRecords": "Eşleşen kayıt bulunamadı",
                    "oPaginate": {
                        "sFirst": "İlk",
                        "sLast": "Son",
                        "sNext": "Sonraki",
                        "sPrevious": "Önceki"
                    },
                    "oAria": {
                        "sSortAscending": ": artan sütun sıralamasını aktifleştir",
                        "sSortDescending": ": azalan sütun sıralamasını aktifleştir"
                    },
                    "select": {
                        "rows": {
                            "_": "%d kayıt seçildi",
                            "0": "",
                            "1": "1 kayıt seçildi"
                        }
                    }
                }
            });
        });
    </script>

    <script>
        CKEDITOR.replace('editor1');
        CKEDITOR.replace('editor2');
        CKEDITOR.replace('editor3');
    </script>

    <script src="~/Content/AdminLayout/assets/extra-libs/sparkline/sparkline.js"></script>
    <script src="~/Content/AdminLayout/dist/js/waves.js"></script>
    <script src="~/Content/AdminLayout/dist/js/sidebarmenu.js"></script>
    <script src="~/Content/AdminLayout/dist/js/custom.min.js"></script>
    <script src="~/Content/AdminLayout/assets/libs/chartist/dist/chartist.min.js"></script>
    <script src="~/Content/AdminLayout/assets/libs/chartist-plugin-tooltips/dist/chartist-plugin-tooltip.min.js"></script>
    <script src="~/Content/AdminLayout/dist/js/pages/dashboards/dashboard1.js"></script>
</body>

</html>
